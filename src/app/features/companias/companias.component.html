<div class="companias-container">
  <button (click)="anadirCompania()" class="btn btn-add">A√±adir Compa√±√≠a</button>

  <!-- Si estamos en modo a√±adir, mostramos el formulario vac√≠o -->
  <div *ngIf="editMode && !editingCompania" class="compania-form">
    <form [formGroup]="companiaForm" (ngSubmit)="onSubmit()">
      <label>
        Nombre:
        <input formControlName="nombre" />
      </label>
      <label>
        Tel√©fono:
        <input formControlName="telefono" />
      </label>
      <label>
        Email:
        <input formControlName="email" />
      </label>
      <label>
        Concertado:
        <input type="checkbox" formControlName="concertado" />
      </label>
      <button type="submit" [disabled]="companiaForm.invalid">Guardar</button>
      <button type="button" (click)="resetForm()">Cancelar</button>
    </form>
  </div>

  <div *ngFor="let compania of companias" class="compania-item">
    <div class="compania-header">
      <button (click)="toggleExpand(compania.id!)" class="btn-toggle">
        {{ expandedIds.has(compania.id!) ? '‚ñº' : '‚ñ∂' }}
      </button>
      <span>{{ compania.nombre }}</span>
      <button (click)="toggleEdit(compania)" title="Editar" class="btn-edit">
        üîë
      </button>
      <button (click)="borrarCompania(compania.id)" class="btn-delete" title="Eliminar">
        üóëÔ∏è
      </button>
    </div>

    <div *ngIf="expandedIds.has(compania.id!)" class="compania-details">
      <form *ngIf="editingCompania?.id === compania.id && editMode" [formGroup]="companiaForm" (ngSubmit)="onSubmit()">
        <label>
          Nombre:
          <input formControlName="nombre" />
        </label>
        <label>
          Tel√©fono:
          <input formControlName="telefono" />
        </label>
        <label>
          Email:
          <input formControlName="email" />
        </label>
        <label>
          Concertado:
          <input type="checkbox" formControlName="concertado" />
        </label>

        <button type="submit" [disabled]="companiaForm.invalid">Guardar</button>
        <button type="button" (click)="resetForm()">Cancelar</button>
      </form>

      <div *ngIf="!(editingCompania?.id === compania.id && editMode)">
        <p><strong>Tel√©fono:</strong> {{ compania.telefono }}</p>
        <p><strong>Email:</strong> {{ compania.email }}</p>
        <p><strong>Concertado:</strong> {{ compania.concertado ? 'S√≠' : 'No' }}</p>
      </div>
    </div>
  </div>
</div>

